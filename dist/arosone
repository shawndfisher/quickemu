#!/usr/bin/env bash

INFO="AROS One|-|https://sites.google.com/view/arosone/arosoneo| x86 distribution which is based on Deadwood's ABI v0 release. Additionally there's a preview of a 68k version."

GUEST="arosone"

function dist_releases() {
    echo $(web_pipe "https://sites.google.com/view/arosone/arosone" | grep -Po "AROS One ABIv0 v\K[0-9.]+")
}

function dist_image_get() {
    local FILEID=$(web_pipe "https://sites.google.com/view/arosone/arosone" | grep -Po 'href="\K.*?(?=")' | grep "https://drive.google.com/file/d/" | head -1 | cut -d"/" -f6)
    URL="https://drive.usercontent.google.com/download?id=${FILEID}&confirm=xxx"
    ISO="ArosOne-x86-v${RELEASE}-ISO-DVD.zip"
    HASH=""

    echo "${URL}/${ISO}"
}

function dist_image_post_get() {
    if [[ ${ISO} = *".zip"* ]]; then
        unzip ${VM_PATH}/${ISO} -d ${VM_PATH}
        rm -f "${VM_PATH}/${ISO}"
        ISO="$(ls -1 "${VM_PATH}/"*.iso | cut -d'/' -f2)"
    fi
}

function dist_vm_option_tweak() {
    echo "boot=\"legacy\"" >> "${CONF_FILE}"
}

# vim:tabstop=4:shiftwidth=4:expandtab
