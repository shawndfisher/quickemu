#!/usr/bin/env bash

PRETTY_NAME="EasyOS"
HOMEPAGE="https://www.easyos.org"
INFO="EasyOS|Independent|-|https://easyos.org/|Experimental distribution designed from scratch to support containers."

IMAGE_TYPE="img"

function dist_releases() {
    #local Y2023=""
    #local Y2024=""
    #Y2024=$(web_pipe https://distro.ibiblio.org/easyos/amd64/releases/kirkstone/2024/ | grep "tr class" | tail +2 | cut -d'"' -f6 | cut -d'/' -f1 | sort -r)
    #Y2023=$(web_pipe https://distro.ibiblio.org/easyos/amd64/releases/kirkstone/2023/ | grep "tr class" | tail +2 | cut -d'"' -f6 | cut -d'/' -f1 | sort -r)
    #echo -n ${2024}
    #echo ${Y2023}
    # Not dynamic for now
    echo 5.8 5.7 5.6.7 5.6.6 5.6.5 5.6.4 5.6.3 5.6.2 5.6.1
}

function dist_image() {
    local HASH=""
    local URL=""
    local ISO=""
    local YEAR=""
    ISO="easy-${RELEASE}-amd64.img"
    case ${RELEASE} in
        5.6.5|5.6.4|5.6.3|5.6.2|5.6.1) YEAR="2023";;
        5.8|5.7|5.6.7|5.6.6)           YEAR="2024";;
    esac
    URL="https://distro.ibiblio.org/easyos/amd64/releases/kirkstone/${YEAR}/${RELEASE}"
    HASH=$(web_pipe "${URL}/md5.sum.txt" | cut -d' ' -f1)
    echo "${URL}/${ISO} ${HASH}"
}

function dist_image_handle() {
    qemu-img convert -f raw -O qcow2 "${VM_PATH}/${ISO}" "${VM_PATH}/disk.qcow2"
    ISO="${ISO/.img/}"
}

# vim:tabstop=4:shiftwidth=4:expandtab
