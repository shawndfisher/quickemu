#!/usr/bin/env bash

INFO="FreeDOS|-|https://freedos.org/|DOS-compatible operating system that you can use to play classic DOS games, run legacy business software, or develop embedded systems."

GUEST="freedos"

function dist_releases() {
    echo 1.3 1.2
}

function dist_image_get() {
    local HASH=""
    local ISO=""
    local URL="http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/${RELEASE}/official"
    case ${RELEASE} in
        1.2) ISO="FD12CD.iso"
             HASH=$(web_pipe "${URL}/FD12.sha" | grep "${ISO}" | cut -d' ' -f1);;
        1.3) ISO="FD13-LiveCD.zip"
             HASH=$(web_pipe "${URL}/verify.txt" | grep -A 8 "sha256sum" | grep "${ISO}" | cut -d' ' -f1);;
    esac
    echo "${URL}/${ISO} ${HASH}"
}

function dist_image_post_get() {
    if [[ ${ISO} = *".zip"* ]]; then
        unzip -qo "${VM_PATH}/${ISO}" -d "${VM_PATH}"
        rm -f "${VM_PATH}/${ISO}"
        ISO="$(ls -1 "${VM_PATH}/"*.iso)"
    fi
}

function dist_vm_option_tweak() {
    echo "boot=\"legacy\"" >> "${CONF_FILE}"
    echo "disk_size=\"4G\"" >> "${CONF_FILE}"
    echo "ram=\"256M\"" >> "${CONF_FILE}"
}

# vim:tabstop=4:shiftwidth=4:expandtab
