#!/usr/bin/env bash

INFO="9Front|-|https://9front.org/|9front is a fork of Plan 9 started to remedy a perceived lack of devoted development resources inside Bell Labs, and has accumulated various fixes and improvements."

GUEST="9front"

function dist_releases() {
    echo latest
}

function dist_image_get() {
    local HASH=""
    local URL="https://9front.org/iso"
    local ISO="$(web_pipe "${URL}" | grep "9front-.*.amd64.iso.gz\"" | cut -d'>' -f2 | cut -d'"' -f4)"
    local HASH_URL="$(web_pipe "https://9front.org/" | grep "releases" | grep "http" | cut -d'"' -f2)"
    
    HASH="$(web_pipe "${HASH_URL}" | grep "9front-.*.amd64.iso.gz" | grep -v "href=" | cut -d' ' -f4)"

    echo "${URL}/${ISO} ${HASH}"
}

function dist_image_post_get() {
    if [[ ${ISO} = *".gz"* ]]; then
        gzip -d ${VM_PATH}/${ISO}
        ISO="${ISO/.gz/}"
    fi
}

# vim:tabstop=4:shiftwidth=4:expandtab
